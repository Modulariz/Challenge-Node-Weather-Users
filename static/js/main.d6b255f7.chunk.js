(this["webpackJsonpchallenge-users"]=this["webpackJsonpchallenge-users"]||[]).push([[0],{160:function(e,a,t){e.exports=t(295)},165:function(e,a,t){},186:function(e,a){},188:function(e,a){},225:function(e,a){},226:function(e,a){},295:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),l=t(50),o=t.n(l),i=(t(165),t(20)),c=t(304),s=t(307),u=t(32),m=t(13),d=t(158),p=t(11),E=t(75),h=t(36),f=t.n(h),b=t(6),y=t(297),g=t(298),v=t(53),O=t(299),C=t(300),w=t(305),k=t(96),j=t(45),x=t(152),S=t.n(x),L="".concat("https://node-weather-challenge.herokuapp.com/","users/id/"),A={_id:"",email:"",__v:0},I={user:A,token:"",isLoading:!0},q={store:I,dispatch:function(e){throw new Error("dispatch no instanciado, intentaste: ".concat(JSON.stringify(e)))}},z=function(e,a){switch(a.type){case"LOADING":return Object(j.a)(Object(j.a)({},e),{},{isLoading:a.payload});case"SAVE_TOKEN":return Object(j.a)(Object(j.a)({},e),{},{token:a.payload});case"SAVE_USER":return Object(j.a)(Object(j.a)({},e),{},{user:a.payload});case"LOG_OUT":return localStorage.removeItem("token"),{user:A,token:"",isLoading:!1};default:throw new Error}},F=Object(n.createContext)(q),D=function(e){var a=e.children,t=Object(n.useReducer)(z,I),l=Object(p.a)(t,2),o=l[0],i=l[1],c=o.token;Object(n.useEffect)((function(){var e=localStorage.getItem("token");i(e?{type:"SAVE_TOKEN",payload:e}:{type:"LOADING",payload:!1})}),[i]),Object(n.useEffect)((function(){i({type:"LOADING",payload:!0});var e=S.a.decode(c);if(e){localStorage.setItem("token",c);var a=L+e.sub;f.a.get(a,{headers:{Authorization:"Bearer ".concat(c)}}).then((function(e){i({type:"SAVE_USER",payload:e.data})})).catch((function(e){return console.log(e)})).finally((function(){return i({type:"LOADING",payload:!1})}))}else i({type:"LOADING",payload:!1})}),[c,i]);var s=Object(n.useMemo)((function(){return{store:o,dispatch:i}}),[o,i]);return r.a.createElement(F.Provider,{value:s},a)},K="".concat("https://node-weather-challenge.herokuapp.com/","users/login"),N=function(){var e=Object(n.useContext)(F).dispatch,a=Object(E.a)(),t=a.register,l=a.handleSubmit,o=a.errors,i=a.formState,c=a.setError,s=Object(n.useState)(!1),m=Object(p.a)(s,2),h=m[0],j=m[1],x=l((function(a){var t=a.email,n=a.password;j(!0),f.a.request({url:K,method:"POST",data:{email:t,password:n}}).then((function(a){e({type:"SAVE_TOKEN",payload:a.data.token})})).catch((function(e){c("email",{message:"El email o la contrase\xf1a son invalidos"}),console.log(e)})).finally((function(){return j(!1)}))}));return r.a.createElement(b.a,null,r.a.createElement(b.a,{textAlign:"center"},r.a.createElement(y.a,{as:"h3"},"Iniciar Sesi\xf3n")),r.a.createElement(g.a,null),r.a.createElement("form",{onSubmit:x},r.a.createElement(v.a,{isInvalid:o.email||o.password},o&&o.email&&r.a.createElement(O.a,null,o.email.message),r.a.createElement(C.a,{htmlFor:"email"},"Email"),r.a.createElement(w.a,{type:"email",name:"email",ref:t({required:"Este campo es requerido."})}),r.a.createElement(C.a,{htmlFor:"password"},"Contrase\xf1a"),r.a.createElement(w.a,{type:"password",name:"password",ref:t({required:"Este campo es requerido."})}),r.a.createElement(b.a,{mt:4,width:"100%",display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",alignItems:"center"},r.a.createElement(k.a,{variantColor:"teal",isLoading:i.isSubmitting,type:"submit"},h?r.a.createElement(d.a,{size:"md"}):"Enviar"),r.a.createElement(k.a,{variant:"link",variantColor:"teal"},r.a.createElement(u.b,{to:"/register"},"Registrarse"))))))},_=t(159),G=function(e){var a=e.children,t=Object(_.a)(e,["children"]);return r.a.createElement(b.a,{width:"100%",display:"flex",justifyContent:"center"},r.a.createElement(b.a,Object.assign({},t,{width:["95%","90%","80%","80%"]}),a))},P=function(e){var a=e.children;return r.a.createElement(b.a,{width:"100vw",height:"90vh",display:"flex",justifyContent:"center",alignItems:"center",position:"absolute",top:"0",left:"0"},r.a.createElement(b.a,{p:"20px",bg:"white",rounded:"md"},a))},T=function(e){var a=e.children,t=Object(n.useContext)(F).store,l=t.user.email;return t.isLoading?r.a.createElement(P,null,r.a.createElement(d.a,{size:"xl"})):l?r.a.createElement(r.a.Fragment,null,a):r.a.createElement(P,null,r.a.createElement(N,null))},R=t(303),V="".concat("https://node-weather-challenge.herokuapp.com/","users/"),B=function(){var e=Object(m.f)(),a=Object(R.a)(),t=Object(E.a)(),l=t.register,o=t.handleSubmit,i=t.errors,c=t.formState,s=t.setError,h=t.clearErrors,j=Object(n.useState)(!1),x=Object(p.a)(j,2),S=x[0],L=x[1],A=o((function(t){var n=t.email,r=t.emailconfirm,l=t.passwordconfirm,o=t.password;h(),n!==r&&s("email",{message:"Los campos de email no coinciden."}),o!==l&&s("password",{message:"Los campos de contrase\xf1a no coinciden."}),L(!0),f.a.request({url:V,method:"POST",data:{email:n,password:o}}).then((function(t){a({title:"Cuenta creada!",description:"Prob\xe1 iniciar sesi\xf3n.",status:"success",duration:9e3,isClosable:!0}),e.replace("/keys")})).catch((function(e){s("email",{message:"Este email ya est\xe1 en uso."}),L(!1),console.log(e)}))}));return r.a.createElement(b.a,null,r.a.createElement(b.a,{textAlign:"center"},r.a.createElement(y.a,{as:"h3"},"Registrarse")),r.a.createElement(g.a,null),r.a.createElement("form",{onSubmit:A},r.a.createElement(v.a,{isInvalid:i.email||i.password},i&&i.email&&r.a.createElement(O.a,null,i.email.message),i&&i.password&&r.a.createElement(O.a,null,i.password.message),r.a.createElement(C.a,{htmlFor:"email"},"Email"),r.a.createElement(w.a,{type:"email",name:"email",ref:l({required:"Falta completar datos de email."})}),r.a.createElement(C.a,{htmlFor:"emailconfirm"},"Confirmar Email"),r.a.createElement(w.a,{type:"email",name:"emailconfirm",ref:l({required:"Falta completar datos de email."})}),r.a.createElement(C.a,{htmlFor:"password"},"Contrase\xf1a"),r.a.createElement(w.a,{type:"password",name:"password",ref:l({required:"Falta completar datos de contrase\xf1a."})}),r.a.createElement(C.a,{htmlFor:"passwordconfirm"},"Confirmar Contrase\xf1a"),r.a.createElement(w.a,{type:"password",name:"passwordconfirm",ref:l({required:"Falta completar datos de contrase\xf1a."})}),r.a.createElement(b.a,{mt:4,width:"100%",display:"flex",flexDirection:"row-reverse",justifyContent:"space-between",alignItems:"center"},r.a.createElement(k.a,{variantColor:"teal",isLoading:c.isSubmitting,type:"submit"},S?r.a.createElement(d.a,{size:"md"}):"Enviar"),r.a.createElement(k.a,{variant:"link",variantColor:"teal"},r.a.createElement(u.b,{to:"/keys"},"Iniciar Sesi\xf3n"))))))},M=function(){var e=Object(n.useContext)(F).store,a=e.user.email;return e.isLoading?r.a.createElement(P,null,r.a.createElement(d.a,{size:"xl"})):a?r.a.createElement(r.a.Fragment,null):r.a.createElement(P,null,r.a.createElement(B,null))},H=t(157),U=t(306),J=t(301),W=t(74),Q=function(){var e=Object(W.useClipboard)(),a=Object(R.a)();return r.a.createElement(G,{p:"20px",bg:"white",rounded:"md",mt:"5px"},r.a.createElement(y.a,{as:"h1",size:"xl"},"Datos meteorol\xf3gicos al azar"),r.a.createElement(g.a,null),r.a.createElement(y.a,{as:"h2",size:"md"},"Acceda a datos metereol\xf3gicos simulados, de cualquier ciudad del mundo. Esta api es un clon de openweather que usa una base de datos de las ciudades del mundo con sus coordenadas, pero devuelve datos clim\xe1ticos azarosos."),r.a.createElement(g.a,null),r.a.createElement(y.a,{as:"h1",size:"xl"},"Obtener datos metereol\xf3gicos de una ciudad"),r.a.createElement(g.a,{opacity:0}),r.a.createElement(H.a,null,"La consulta se hace por nombre de ciudad. Vas a necesitar una api key para hacer esta petici\xf3n, para obtener una debes ir al panel de"," ",r.a.createElement(u.b,{to:"/keys",style:{color:"teal",fontWeight:"bold"}},"Mis Llaves")),r.a.createElement(g.a,{opacity:0}),r.a.createElement(b.a,{display:"flex",flexWrap:"wrap"},r.a.createElement(U.a,null,"https://node-weather-challenge.herokuapp.com/weather?q="),r.a.createElement(U.a,{variantColor:"red"},"Ciudad"),r.a.createElement(U.a,null,"&appid="),r.a.createElement(U.a,{variantColor:"red"},"API key"),r.a.createElement(J.a,{onClick:function(){return t="https://node-weather-challenge.herokuapp.com/weather?q=Ciudad&appid=API key",e.copy(t),void a({title:"Endpoint copiado al portapapeles!",description:"No te olvides de cambiar todo lo rojo por tus datos.",status:"success",duration:9e3,isClosable:!0});var t},"aria-label":"delete api key",icon:"copy",variant:"ghost",variantColor:"teal"})))},X=t(156),Y=function(){var e=Object(n.useContext)(F),a=e.store.user.email,t=e.dispatch;return r.a.createElement(X.a,{as:"nav",align:"center",justify:"space-between",wrap:"wrap",bg:"teal.500",color:"white",position:"sticky",top:0,left:0,width:"100%",zIndex:3},r.a.createElement(G,{display:"flex",justifyContent:"right"},r.a.createElement(k.a,{variant:"link",m:"15px",variantColor:"white"},r.a.createElement(u.b,{to:"/"},"Docs")),r.a.createElement(k.a,{variant:"link",m:"15px",variantColor:"white"},r.a.createElement(u.b,{to:"/keys"},a?"Mis Llaves":"Iniciar Sesi\xf3n")),a?r.a.createElement(k.a,{variant:"link",m:"15px",variantColor:"white",onClick:function(){return t({type:"LOG_OUT",payload:null})}},"Cerrar Sesi\xf3n"):r.a.createElement(k.a,{variant:"link",m:"15px",variantColor:"white"},r.a.createElement(u.b,{to:"/register"},"Registrarse"))))},Z=t(302),$=function(e){var a=e.apiKey,t=e.onDeleteClick,n=e.onCopyClick;return r.a.createElement(b.a,{display:"flex",alignItems:"center",padding:"5px"},r.a.createElement(U.a,{mr:"5px"},a," "),r.a.createElement(J.a,{onClick:function(){return n()},"aria-label":"delete api key",icon:"copy",variant:"ghost",variantColor:"teal"}),r.a.createElement(J.a,{onClick:function(){return t()},"aria-label":"delete api key",icon:"delete",variant:"ghost",variantColor:"red"}))},ee="".concat("https://node-weather-challenge.herokuapp.com/","apikeys"),ae=function(e){var a=Object(R.a)(),t=Object(n.useState)(!1),r=Object(p.a)(t,2),l=r[0],o=r[1],i=Object(n.useState)(null),c=Object(p.a)(i,2),s=c[0],u=c[1],m=Object(n.useState)(null),d=Object(p.a)(m,2),E=d[0],h=d[1],b=Object(n.useCallback)((function(){o(!0),f.a.get(ee,{headers:{Authorization:"Bearer ".concat(e)}}).then((function(e){h(e.data),u(null)})).catch((function(e){e.response&&u(e.response.data)})).finally((function(){return o(!1)}))}),[e]),y=Object(n.useCallback)((function(){f.a.request({method:"POST",url:ee,headers:{Authorization:"Bearer ".concat(e)}}).then((function(e){return a({title:"Llave generada!",description:e.data.key,status:"success",duration:3e3,isClosable:!0})})).catch((function(e){e.response&&a({title:"Oops!",description:"Ha habido un error generando una llave. Intentalo mas tarde!",status:"error",duration:3e3,isClosable:!0})})).finally((function(){return b()}))}),[b,a,e]),g=Object(n.useCallback)((function(t){f.a.delete("".concat(ee,"/").concat(t),{headers:{Authorization:"Bearer ".concat(e)}}).then((function(e){return a({title:"Llave eliminada",description:e.data.key,status:"info",duration:3e3,isClosable:!0})})).catch((function(e){e.response&&a({title:"Oops!",description:"Ha habido un error eliminando una llave. Intentalo mas tarde!",status:"error",duration:3e3,isClosable:!0})})).finally((function(){return b()}))}),[b,a,e]);return Object(n.useEffect)((function(){b()}),[b]),Object(n.useEffect)((function(){s&&a({title:"Oops!",description:"Ha habido un obteniendo tus llaves. Intentalo mas tarde!",status:"error",duration:3e3,isClosable:!0})}),[s,a]),{apiKeys:E,isLoading:l,error:s,generateApiKey:y,deleteApiKey:g}},te=function(){var e=Object(n.useContext)(F).store.token,a=ae(e),t=a.isLoading,l=a.apiKeys,o=a.error,i=a.generateApiKey,c=a.deleteApiKey,s=Object(R.a)(),u=Object(W.useClipboard)();return r.a.createElement(G,{p:"20px",bg:"white",rounded:"md",mt:"5px"},r.a.createElement(y.a,{as:"h1",size:"xl"},"Mis Llaves"),r.a.createElement(g.a,null),r.a.createElement(y.a,{as:"h2",size:"md"},"Con estas llaves, o keys, vas a tener acceso a la api, podes generar cuantas quieras y revocarlas en cualquier momento."),r.a.createElement(g.a,null),r.a.createElement(k.a,{variantColor:"teal",onClick:i},"Generar una Nueva Llave"),r.a.createElement(g.a,{opacity:0}),r.a.createElement(y.a,{as:"h3",size:"sm"},"Llaves:"),t&&r.a.createElement(d.a,{size:"lg"}),!t&&!o&&l&&r.a.createElement(Z.b,{as:"ul"},l.map((function(e){return r.a.createElement(Z.a,null,r.a.createElement($,{apiKey:e.key,onDeleteClick:function(){return c(e._id)},onCopyClick:function(){return a=e.key,u.copy(a),void s({title:"Llave copiada al portapapeles!",description:"Hac\xe9 una app genial.",status:"success",duration:9e3,isClosable:!0});var a}}))}))),l&&0===l.length&&r.a.createElement(H.a,null,"Parece que no has generado ninguna llave... Apret\xe1 ese boton verde gigante!"))},ne=function(){return r.a.createElement(D,null,r.a.createElement(i.a,{theme:c.a},r.a.createElement(s.a,null),r.a.createElement(u.a,null,r.a.createElement(Y,null),r.a.createElement(m.c,null,r.a.createElement(m.a,{exact:!0,path:"/"},r.a.createElement(Q,null)),r.a.createElement(m.a,{path:"/keys"},r.a.createElement(T,null,r.a.createElement(te,null))),r.a.createElement(m.a,{path:"/register"},r.a.createElement(M,null))))))};o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(ne,null)),document.getElementById("root"))}},[[160,1,2]]]);
//# sourceMappingURL=main.d6b255f7.chunk.js.map